<script>
  window.token = '<%= form_authenticity_token %>'
</script>
<%= link_to "Add Goal", new_goal_path %>
<div id="goals">
  <% if !@goals.blank? %>
    <table>
      <tr>
        <th></th>
        <% 6.downto(0) do |i| %>
          <th><%= (Date.today - i).strftime("%m/%d") %> </th>
        <% end %>
      </tr>
      <% for goal in @goals %>
        <tr>
          <th>
            <%= goal.name %>
          </th>
          <% 6.downto(0) do |i| %>
            <%= content_tag :td, class: "goal-available", data: { date: (Date.today - i).to_s, action: ( goal.entries_on_date?( Date.today-i ) ? "delete" : "put" ), goal_id: goal.id } do%>
              <%= goal.entries_on_date?( Date.today-i ) ? "X" : " " %>
            <% end %>
          <% end %>
          <td>
            Checks: <%= goal.goal_entries.count %><br />
            Current Chain: <br />
            Longest Chain: <%= goal.longest_chain %><br />
        </tr>
      <% end %>
    </table>
  <% else %>
    You have no goals. Why not <%= link_to "create", new_goal_path %> one?
  <% end %>
</div>